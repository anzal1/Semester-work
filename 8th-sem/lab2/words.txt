Inmathematics,apermutationofasetis,looselyspeaking,anarrangementofitsmembersintoasequenceorlinearorder,orifthesetisalreadyordered,arearrangementofitselementsTheword``permutation''alsoreferstotheactorprocessofchangingthelinearorderofanorderedset[1]Forexample,therearesixpermutations(orderings)oftheset{1,2,3}:writtenastuples,theyare(1,2,3),(1,3,2),(2,1,3),(2,3,1),(3,1,2),and(3,2,1)Anagramsofawordwhoselettersarealldifferentarealsopermutations:thelettersarealreadyorderedintheoriginalword,andtheanagramreordersthemThestudyofpermutationsoffinitesetsisanimportanttopicincombinatoricsandgrouptheoryPermutationsareusedinalmosteverybranchofmathematicsandinmanyotherfieldsofscienceIncomputerscience,theyareusedforanalyzingsortingalgorithms;inquantumphysics,fordescribingstatesofparticles;andinbiology,fordescribingRNAsequencesThenumberofpermutationsofndistinctobjectsisnfactorial,usuallywrittenasn!,whichmeanstheproductofallpositiveintegerslessthanorequaltonFormally,apermutationofasetSisdefinedasabijectionfromStoitself[2][3]Thatis,itisafunctionfromStoSforwhicheveryelementoccursexactlyonceasanimagevalueSuchafunctionf:S→S{\displaystylef:S\toS}isequivalenttotherearrangementoftheelementsofSinwhicheachelementiisreplacedbythecorrespondingf(i){\displaystylef(i)}Forexample,thepermutation(3,1,2)isdescribedbythefunctionσ{\displaystyle\sigma}definedasThecollectionofallpermutationsofasetformagroupcalledthesymmetricgroupofthesetThegroupoperationisthecompositionoffunctions(performingonerearrangementaftertheother),whichresultsinanotherfunction(rearrangement)Thepropertiesofpermutationsdonotdependonthenatureoftheelementsbeingpermuted,onlyontheirnumber,sooneoftenconsidersthestandardsetS={1,2,…,n}{\displaystyleS=\{1,2,\ldots,n\}}Inelementarycombinatorics,thek-permutations,orpartialpermutations,aretheorderedarrangementsofkdistinctelementsselectedfromasetWhenkisequaltothesizeoftheset,thesearethepermutationsintheprevioussensePermutationscalledhexagramswereusedinChinaintheIChing(Pinyin:YiJing)asearlyas1000BCInGreece,PlutarchwrotethatXenocratesofChalcedon(396–314BC)discoveredthenumberofdifferentsyllablespossibleintheGreeklanguageThiswouldhavebeenthefirstattemptonrecordtosolveadifficultprobleminpermutationsandcombinations[4]Al-Khalil(717–786),anArabmathematicianandcryptographer,wrotetheBookofCryptographicMessagesItcontainsthefirstuseofpermutationsandcombinations,tolistallpossibleArabicwordswithandwithoutvowels[5]TheruletodeterminethenumberofpermutationsofnobjectswasknowninIndianculturearound1150ADTheLilavatibytheIndianmathematicianBhaskaraIIcontainsapassagethattranslatesasfollows:Theproductofmultiplicationofthearithmeticalseriesbeginningandincreasingbyunityandcontinuedtothenumberofplaces,willbethevariationsofnumberwithspecificfigures[6]In1677,FabianStedmandescribedfactorialswhenexplainingthenumberofpermutationsofbellsinchangeringingStartingfromtwobells:``first,twomustbeadmittedtobevariedintwoways'',whichheillustratesbyshowing12and21[7]Hethenexplainsthatwiththreebellsthereare``threetimestwofigurestobeproducedoutofthree''whichagainisillustratedHisexplanationinvolves``castaway3,and12willremain;castaway2,and13willremain;castaway1,and23willremain''[8]HethenmovesontofourbellsandrepeatsthecastingawayargumentshowingthattherewillbefourdifferentsetsofthreeEffectively,thisisarecursiveprocessHecontinueswithfivebellsusingthe``castingaway''methodandtabulatestheresulting120combinations[9]Atthispointhegivesupandremarks:Nowthenatureofthesemethodsissuch,thatthechangesononenumbercomprehendsthechangesonalllessernumbers,insomuchthatacompleatPealofchangesononenumberseemethtobeformedbyunitingofthecompleatPealsonalllessernumbersintooneentirebody;[10]Stedmanwidenstheconsiderationofpermutations;hegoesontoconsiderthenumberofpermutationsofthelettersofthealphabetandofhorsesfromastableof20[11]Afirstcaseinwhichseeminglyunrelatedmathematicalquestionswerestudiedwiththehelpofpermutationsoccurredaround1770,whenJosephLouisLagrange,inthestudyofpolynomialequations,observedthatpropertiesofthepermutationsoftherootsofanequationarerelatedtothepossibilitiestosolveitThislineofworkultimatelyresulted,throughtheworkofÉvaristeGalois,inGaloistheory,whichgivesacompletedescriptionofwhatispossibleandimpossiblewithrespecttosolvingpolynomialequations(inoneunknown)byradicalsInmodernmathematics,therearemanysimilarsituationsinwhichunderstandingaproblemrequiresstudyingcertainpermutationsrelatedtoitPermutationsplayedanimportantroleinthecryptanalysisoftheEnigmamachine,acipherdeviceusedbyNaziGermanyduringWorldWarIIInparticular,oneimportantpropertyofpermutations,namely,thattwopermutationsareconjugateexactlywhentheyhavethesamecycletype,wasusedbycryptologistMarianRejewskitobreaktheGermanEnigmacipherinturnofyears1932-1933[12][13]InmathematicstextsitiscustomarytodenotepermutationsusinglowercaseGreeklettersCommonly,eitherα,β,γ{\displaystyle\alpha,\beta,\gamma}orσ,τ,ρ,π{\displaystyle\sigma,\tau,\rho,\pi}areused[14]Apermutationcanbedefinedasabijection(aninvertiblemapping,aone-to-oneandontofunction)fromasetStoitself:σ:S⟶∼S{\displaystyle\sigma:S\{\stackrel{\sim}{\longrightarrow}}\S}Theidentitypermutationisdefinedbyσ(x)=x{\displaystyle\sigma(x)=x}forallelementsx∈S{\displaystylex\inS},andcanbedenotedbythenumber1{\displaystyle1},[a]byid=idS{\displaystyle{\text{id}}={\text{id}}_{S}},orbyasingle1-cycle(x)[15][16]ThesetofallpermutationsofasetwithnelementsformsthesymmetricgroupSn{\displaystyleS_{n}},wherethegroupoperationiscompositionoffunctionsThusfortwopermutationsσ{\displaystyle\sigma}andτ{\displaystyle\tau}inthegroupSn{\displaystyleS_{n}},theirproductπ=στ{\displaystyle\pi=\sigma\tau}isdefinedby:π(i)=σ(τ(i)){\displaystyle\pi(i)=\sigma(\tau(i))}CompositionisusuallywrittenwithoutadotorothersignIngeneral,compositionoftwopermutationsisnotcommutative:τσ≠στ{\displaystyle\tau\sigma\neq\sigma\tau}Asabijectionfromasettoitself,apermutationisafunctionthatperformsarearrangementofaset,termedanactivepermutationorsubstitutionAnolderviewpointseesapermutationasanorderedarrangementorlistofalltheelementsofS,calledapassivepermutation(see§One-linenotationbelow)[17]Apermutationσ{\displaystyle\sigma}canbedecomposedintooneormoredisjointcycleswhicharetheorbitsofthecyclicgroup⟨σ⟩={1,σ,σ2,…}{\displaystyle\langle\sigma\rangle=\{1,\sigma,\sigma^{2},\ldots\}}actingonthesetSAcycleisfoundbyrepeatedlyapplyingthepermutationtoanelement:x,σ(x),σ(σ(x)),…,σk−1(x){\displaystylex,\sigma(x),\sigma(\sigma(x)),\ldots,\sigma^{k-1}(x)},whereweassumeσk(x)=x{\displaystyle\sigma^{k}(x)=x}Acycleconsistingofkelementsiscalledak-cycle(See§Cyclenotationbelow)Afixedpointofapermutationσ{\displaystyle\sigma}isanelementxwhichistakentoitself,thatisσ(x)=x{\displaystyle\sigma(x)=x},forminga1-cycle(x){\displaystyle(\,x\,)}ApermutationwithnofixedpointsiscalledaderangementApermutationexchangingtwoelements(asingle2-cycle)andleavingtheothersfixediscalledatranspositionSeveralnotationsarewidelyusedtorepresentpermutationsconvenientlyCyclenotationisapopularchoice,asitiscompactandshowsthepermutation'sstructureclearlyThisarticlewillusecyclenotationunlessotherwisespecifiedCauchy'stwo-linenotation[18]liststheelementsofSinthefirstrow,andtheimageofeachelementbelowitinthesecondrowForexample,thepermutationofS={1,2,3,4,5,6}givenbythefunctionσ(1)=2,σ(2)=6,σ(3)=5,σ(4)=4,σ(5)=3,σ(6)=1{\displaystyle\sigma(1)=2,\\\sigma(2)=6,\\\sigma(3)=5,\\\sigma(4)=4,\\\sigma(5)=3,\\\sigma(6)=1}canbewrittenasTheelementsofSmayappearinanyorderinthefirstrow,sothispermutationcouldalsobewritten:Ifthereisa``natural''orderfortheelementsofS,[b]sayx1,x2,…,xn{\displaystylex_{1},x_{2},\ldots,x_{n}},thenoneusesthisforthefirstrowofthetwo-linenotation:Underthisassumption,onemayomitthefirstrowandwritethepermutationinone-linenotationasthatis,asanorderedarrangementoftheelementsofS[19][20]Caremustbetakentodistinguishone-linenotationfromthecyclenotationdescribedbelow:acommonusageistoomitparenthesesorotherenclosingmarksforone-linenotation,whileusingparenthesesforcyclenotationTheone-linenotationisalsocalledthewordrepresentation[21]Theexampleabovewouldthenbe:σ=(123456265431)=265431{\displaystyle\sigma={\begin{pmatrix}1&2&3&4&5&6\\2&6&5&4&3&1\end{pmatrix}}=265431}(Itistypicaltousecommastoseparatetheseentriesonlyifsomehavetwoormoredigits)ThiscompactformiscommoninelementarycombinatoricsandcomputerscienceItisespeciallyusefulinapplicationswherethepermutationsaretobecomparedaslargerorsmallerusinglexicographicorderCyclenotationdescribestheeffectofrepeatedlyapplyingthepermutationontheelementsofthesetS,withanorbitbeingcalledacycleThepermutationiswrittenasalistofcycles;sincedistinctcyclesinvolvedisjointsetsofelements,thisisreferredtoas``decompositionintodisjointcycles''Towritedownthepermutationσ{\displaystyle\sigma}incyclenotation,oneproceedsasfollows:Also,itiscommontoomit1-cycles,sincethesecanbeinferred:foranyelementxinSnotappearinginanycycle,oneimplicitlyassumesσ(x)=x{\displaystyle\sigma(x)=x}[22]Followingtheconventionofomitting1-cycles,onemayinterpretanindividualcycleasapermutationwhichfixesalltheelementsnotinthecycle(acyclicpermutationhavingonlyonecycleoflengthgreaterthan1)ThenthelistofdisjointcyclescanbeseenasthecompositionofthesecyclicpermutationsForexample,theone-linepermutationσ=265431{\displaystyle\sigma=265431}canbewrittenincyclenotationas:σ=(126)(35)(4)=(126)(35){\displaystyle\sigma=(126)(35)(4)=(126)(35)}Thismaybeseenasthecompositionσ=κ1κ2{\displaystyle\sigma=\kappa_{1}\kappa_{2}}ofcyclicpermutations:κ1=(126)=(126)(3)(4)(5),κ2=(35)=(35)(1)(2)(6){\displaystyle\kappa_{1}=(126)=(126)(3)(4)(5),\quad\kappa_{2}=(35)=(35)(1)(2)(6)}Whilepermutationsingeneraldonotcommute,disjointcyclesdo;forexample:σ=(126)(35)=(35)(126){\displaystyle\sigma=(126)(35)=(35)(126)}Also,eachcyclecanberewrittenfromadifferentstartingpoint;forexample,σ=(126)(35)=(261)(53){\displaystyle\sigma=(126)(35)=(261)(53)}ThusonemaywritethedisjointcyclesofagivenpermutationinmanydifferentwaysAconvenientfeatureofcyclenotationisthatinvertingthepermutationisgivenbyreversingtheorderoftheelementsineachcycleForexample,σ−1=(A2(126)(35))−1=(621)(53){\displaystyle\sigma^{-1}=\left({\vphantom{A^{2}}}(126)(35)\right)^{-1}=(621)(53)}Insomecombinatorialcontextsitisusefultofixacertainorderfortheelementsinthecyclesandofthe(disjoint)cyclesthemselvesMiklósBónacallsthefollowingorderingchoicesthecanonicalcyclenotation:Forexample,(513)(6)(827)(94)isapermutationofS={1,2,,9}incanonicalcyclenotation[23]RichardStanleycallsthisthe``standardrepresentation''ofapermutation,[24]andMartinAigneruses``standardform''[21]SergeyKitaevalsousesthe``standardform''terminology,butreversesbothchoices;thatis,eachcyclelistsitsminimalelementfirst,andthecyclesaresortedindecreasingorderoftheirminimalelements[25]TherearetwowaystodenotethecompositionoftwopermutationsInthemostcommonnotation,σ⋅τ{\displaystyle\sigma\cdot\tau}isthefunctionthatmapsanyelementxtoσ(τ(x)){\displaystyle\sigma(\tau(x))}Therightmostpermutationisappliedtotheargumentfirst,[26]becausetheargumentiswrittentotherightofthefunctionAdifferentruleformultiplyingpermutationscomesfromwritingtheargumenttotheleftofthefunction,sothattheleftmostpermutationactsfirst[27][28][29]Inthisnotation,thepermutationisoftenwrittenasanexponent,soσactingonxiswrittenxσ;thentheproductisdefinedbyxσ⋅τ=(xσ)τ{\displaystylex^{\sigma\cdot\tau}=(x^{\sigma})^{\tau}}Thisarticleusesthefirstdefinition,wheretherightmostpermutationisappliedfirstThefunctioncompositionoperationsatisfiestheaxiomsofagroupItisassociative,meaning(ρσ)τ=ρ(στ){\displaystyle(\rho\sigma)\tau=\rho(\sigma\tau)},andproductsofmorethantwopermutationsareusuallywrittenwithoutparenthesesThecompositionoperationalsohasanidentityelement(theidentitypermutationid{\displaystyle{\text{id}}}),andeachpermutationσ{\displaystyle\sigma}hasaninverseσ−1{\displaystyle\sigma^{-1}}(itsinversefunction)withσ−1σ=σσ−1=id{\displaystyle\sigma^{-1}\sigma=\sigma\sigma^{-1}={\text{id}}}Theconceptofapermutationasanorderedarrangementadmitsseveralgeneralizationsthathavebeencalledpermutations,especiallyinolderliteratureInolderliteratureandelementarytextbooks,ak-permutationofn(sometimescalledapartialpermutation,sequencewithoutrepetition,variation,orarrangement)meansanorderedarrangement(list)ofak-elementsubsetofann-set[c][30][31]Thenumberofsuchk-permutations(k-arrangements)ofn{\displaystylen}isdenotedvariouslybysuchsymbolsasPkn{\displaystyleP_{k}^{n}},nPk{\displaystyle_{n}P_{k}},nPk{\displaystyle^{n}\!P_{k}},Pn,k{\displaystyleP_{n,k}},P(n,k){\displaystyleP(n,k)},orAnk{\displaystyleA_{n}^{k}},[32]computedbytheformula:[33]whichis0whenk>n,andotherwiseisequaltoTheproductiswelldefinedwithouttheassumptionthatn{\displaystylen}isanon-negativeinteger,andisofimportanceoutsidecombinatoricsaswell;itisknownasthePochhammersymbol(n)k{\displaystyle(n)_{k}}orasthek{\displaystylek}-thfallingfactorialpowernk_{\displaystylen^{\underline{k}}}:P(n,k)=nPk=(n)k=nk_{\displaystyleP(n,k)={_{n}}P_{k}=(n)_{k}=n^{\underline{k}}}ThisusageofthetermpermutationiscloselyassociatedwiththetermcombinationtomeanasubsetAk-combinationofasetSisak-elementsubsetofS:theelementsofacombinationarenotorderedOrderingthek-combinationsofSinallpossiblewaysproducesthek-permutationsofSThenumberofk-combinationsofann-set,C(n,k),isthereforerelatedtothenumberofk-permutationsofnby:Thesenumbersarealsoknownasbinomialcoefficients,usuallydenoted(nk){\displaystyle{\tbinom{n}{k}}}:C(n,k)=nCk=(nk){\displaystyleC(n,k)={_{n}}C_{k}={\binom{n}{k}}}OrderedarrangementsofkelementsofasetS,whererepetitionisallowed,arecalledk-tuplesTheyhavesometimesbeenreferredtoaspermutationswithrepetition,althoughtheyarenotpermutationsintheusualsenseTheyarealsocalledwordsoverthealphabetSIfthesetShasnelements,thenumberofk-tuplesoverSisnk{\displaystylen^{k}}AformallanguageisasetofwordsobeyingspecifiedrulesIfMisafinitemultiset,thenamultisetpermutationisanorderedarrangementofelementsofMinwhicheachelementappearsanumberoftimesequalexactlytoitsmultiplicityinMAnanagramofawordhavingsomerepeatedlettersisanexampleofamultisetpermutation[d]IfthemultiplicitiesoftheelementsofM(takeninsomeorder)arem1{\displaystylem_{1}},m2{\displaystylem_{2}},,ml{\displaystylem_{l}}andtheirsum(thatis,thesizeofM)isn,thenthenumberofmultisetpermutationsofMisgivenbythemultinomialcoefficient,[34]Forexample,thenumberofdistinctanagramsofthewordMISSISSIPPIis:[35]Ak-permutationofamultisetMisasequenceofkelementsofMinwhicheachelementappearsanumberoftimeslessthanorequaltoitsmultiplicityinM(anelement'srepetitionnumber)Permutations,whenconsideredasarrangements,aresometimesreferredtoaslinearlyorderedarrangementsIf,however,theobjectsarearrangedinacircularmannerthisdistinguishedorderingisweakened:thereisno``firstelement''inthearrangement,asanyelementcanbeconsideredasthestartAnarrangementofdistinctobjectsinacircularmanneriscalledacircularpermutation[36][e]Thesecanbeformallydefinedasequivalenceclassesofordinarypermutationsoftheseobjects,fortheequivalencerelationgeneratedbymovingthefinalelementofthelineararrangementtoitsfrontTwocircularpermutationsareequivalentifonecanberotatedintotheotherThefollowingfourcircularpermutationsonfourlettersareconsideredtobethesameThecirculararrangementsaretobereadcounter-clockwise,sothefollowingtwoarenotequivalentsincenorotationcanbringonetotheotherThereare(n–1)!circularpermutationsofasetwithnelementsThenumberofpermutationsofndistinctobjectsisn!Thenumberofn-permutationswithkdisjointcyclesisthesignlessStirlingnumberofthefirstkind,denotedc(n,k){\displaystylec(n,k)}or[nk]{\displaystyle[{\begin{smallmatrix}n\\k\end{smallmatrix}}]}[37]Thecycles(includingthefixedpoints)ofapermutationσ{\displaystyle\sigma}ofasetwithnelementspartitionthatset;sothelengthsofthesecyclesformanintegerpartitionofn,whichiscalledthecycletype(orsometimescyclestructureorcycleshape)ofσ{\displaystyle\sigma}Thereisa``1''inthecycletypeforeveryfixedpointofσ{\displaystyle\sigma},a``2''foreverytransposition,andsoonThecycletypeofβ=(125)(34)(68)(7){\displaystyle\beta=(1\,2\,5\,)(\,3\,4\,)(6\,8\,)(\,7\,)}is(3,2,2,1){\displaystyle(3,2,2,1)}Thismayalsobewritteninamorecompactformas[112231]Moreprecisely,thegeneralformis[1α12α2⋯nαn]{\displaystyle[1^{\alpha_{1}}2^{\alpha_{2}}\dotsmn^{\alpha_{n}}]},whereα1,…,αn{\displaystyle\alpha_{1},\ldots,\alpha_{n}}arethenumbersofcyclesofrespectivelengthThenumberofpermutationsofagivencycletypeis[38]Thenumberofcycletypesofasetwithnelementsequalsthevalueofthepartitionfunctionp(n){\displaystylep(n)}Polya'scycleindexpolynomialisageneratingfunctionwhichcountspermutationsbytheircycletypeIngeneral,composingpermutationswrittenincyclenotationfollowsnoeasilydescribedpattern–thecyclesofthecompositioncanbedifferentfromthosebeingcomposedHoweverthecycletypeispreservedinthespecialcaseofconjugatingapermutationσ{\displaystyle\sigma}byanotherpermutationπ{\displaystyle\pi},whichmeansformingtheproductπσπ−1{\displaystyle\pi\sigma\pi^{-1}}Here,πσπ−1{\displaystyle\pi\sigma\pi^{-1}}istheconjugateofσ{\displaystyle\sigma}byπ{\displaystyle\pi}anditscyclenotationcanbeobtainedbytakingthecyclenotationforσ{\displaystyle\sigma}andapplyingπ{\displaystyle\pi}toalltheentriesinit[39]ItfollowsthattwopermutationsareconjugateexactlywhentheyhavethesamecycletypeTheorderofapermutationσ{\displaystyle\sigma}isthesmallestpositiveintegermsothatσm=id{\displaystyle\sigma^{m}=\mathrm{id}}ItistheleastcommonmultipleofthelengthsofitscyclesForexample,theorderofσ=(152)(34){\displaystyle\sigma=(152)(34)}islcm(3,2)=6{\displaystyle{\text{lcm}}(3,2)=6}Everypermutationofafinitesetcanbeexpressedastheproductoftranspositions[40]Althoughmanysuchexpressionsforagivenpermutationmayexist,eithertheyallcontainanevennumberoftranspositionsortheyallcontainanoddnumberoftranspositionsThusallpermutationscanbeclassifiedasevenorodddependingonthisnumberThisresultcanbeextendedsoastoassignasign,writtensgn⁡σ{\displaystyle\operatorname{sgn}\sigma},toeachpermutationsgn⁡σ=+1{\displaystyle\operatorname{sgn}\sigma=+1}ifσ{\displaystyle\sigma}isevenandsgn⁡σ=−1{\displaystyle\operatorname{sgn}\sigma=-1}ifσ{\displaystyle\sigma}isoddThenfortwopermutationsσ{\displaystyle\sigma}andπ{\displaystyle\pi}Itfollowsthatsgn⁡(σσ−1)=+1{\displaystyle\operatorname{sgn}\left(\sigma\sigma^{-1}\right)=+1}Thesignofapermutationisequaltothedeterminantofitspermutationmatrix(below)Apermutationmatrixisann×nmatrixthathasexactlyoneentry1ineachcolumnandineachrow,andallotherentriesare0Thereareseveralwaystoassignapermutationmatrixtoapermutationof{1,2,,n}OnenaturalapproachistodefineLσ{\displaystyleL_{\sigma}}tobethelineartransformationofRn{\displaystyle\mathbb{R}^{n}}whichpermutesthestandardbasis{e1,…,en}{\displaystyle\{\mathbf{e}_{1},\ldots,\mathbf{e}_{n}\}}byLσ(ej)=eσ(j){\displaystyleL_{\sigma}(\mathbf{e}_{j})=\mathbf{e}_{\sigma(j)}},anddefineMσ{\displaystyleM_{\sigma}}tobeitsmatrixThatis,Mσ{\displaystyleM_{\sigma}}hasitsjthcolumnequaltothen×1columnvectoreσ(j){\displaystyle\mathbf{e}_{\sigma(j)}}:its(i,j)entryisto1ifi=σ(j),and0otherwiseSincecompositionoflinearmappingsisdescribedbymatrixmultiplication,itfollowsthatthisconstructioniscompatiblewithcompositionofpermutations:MσMτ=Mστ{\displaystyleM_{\sigma}M_{\tau}=M_{\sigma\tau}}Forexample,theone-linepermutationsσ=213,τ=231{\displaystyle\sigma=213,\\tau=231}haveproductστ=132{\displaystyle\sigma\tau=132},andthecorrespondingmatricesare:MσMτ=(010100001)(001100010)=(100001010)=Mστ{\displaystyleM_{\sigma}M_{\tau}={\begin{pmatrix}0&1&0\\1&0&0\\0&0&1\end{pmatrix}}{\begin{pmatrix}0&0&1\\1&0&0\\0&1&0\end{pmatrix}}={\begin{pmatrix}1&0&0\\0&0&1\\0&1&0\end{pmatrix}}=M_{\sigma\tau}}Itisalsocommonintheliteraturetofindtheinverseconvention,whereapermutationσisassociatedtothematrixPσ=(Mσ)−1=(Mσ)T{\displaystyleP_{\sigma}=(M_{\sigma})^{-1}=(M_{\sigma})^{T}}whose(i,j)entryis1ifj=σ(i)andis0otherwiseInthisconvention,permutationmatricesmultiplyintheoppositeorderfrompermutations,thatis,PσPτ=Pτσ{\displaystyleP_{\sigma}P_{\tau}=P_{\tau\sigma}}Inthiscorrespondence,permutationmatricesactontherightsideofthestandard1×n{\displaystyle1\timesn}rowvectors(ei)T{\displaystyle({\bf{e}}_{i})^{T}}:(ei)TPσ=(eσ(i))T{\displaystyle({\bf{e}}_{i})^{T}P_{\sigma}=({\bf{e}}_{\sigma(i)})^{T}}TheCayleytableontherightshowsthesematricesforpermutationsof3elementsInsomeapplications,theelementsofthesetbeingpermutedwillbecomparedwitheachotherThisrequiresthatthesetShasatotalordersothatanytwoelementscanbecomparedTheset{1,2,,n}withtheusual≤relationisthemostfrequentlyusedsetintheseapplicationsAnumberofpropertiesofapermutationaredirectlyrelatedtothetotalorderingofS,consideringthepermutationwritteninone-linenotationasasequenceσ=σ(1)σ(2)⋯σ(n){\displaystyle\sigma=\sigma(1)\sigma(2)\cdots\sigma(n)}Anascentofapermutationσofnisanypositioni<nwherethefollowingvalueisbiggerthanthecurrentoneThatis,iisanascentifσ(i)<σ(i+1){\displaystyle\sigma(i)<\sigma(i{+}1)}Forexample,thepermutation3452167hasascents(atpositions)1,2,5,and6Similarly,adescentisapositioni<nwithσ(i)>σ(i+1){\displaystyle\sigma(i)>\sigma(i{+}1)},soeveryiwith1≤i<n{\displaystyle1\leqi<n}iseitheranascentoradescentAnascendingrunofapermutationisanonemptyincreasingcontiguoussubsequencethatcannotbeextendedateitherend;itcorrespondstoamaximalsequenceofsuccessiveascents(thelattermaybeempty:betweentwosuccessivedescentsthereisstillanascendingrunoflength1)Bycontrastanincreasingsubsequenceofapermutationisnotnecessarilycontiguous:itisanincreasingsequenceobtainedbyomittingsomeofthevaluesoftheone-linenotationForexample,thepermutation2453167hastheascendingruns245,3,and167,whileithasanincreasingsubsequence2367Ifapermutationhask−1descents,thenitmustbetheunionofkascendingruns[41]Thenumberofpermutationsofnwithkascentsis(bydefinition)theEuleriannumber⟨nk⟩{\displaystyle\textstyle\left\langle{n\atopk}\right\rangle};thisisalsothenumberofpermutationsofnwithkdescentsSomeauthorshoweverdefinetheEuleriannumber⟨nk⟩{\displaystyle\textstyle\left\langle{n\atopk}\right\rangle}asthenumberofpermutationswithkascendingruns,whichcorrespondstok−1descents[42]Anexceedanceofapermutationσ1σ2σnisanindexjsuchthatσj>jIftheinequalityisnotstrict(thatis,σj≥j),thenjiscalledaweakexceedanceThenumberofn-permutationswithkexceedancescoincideswiththenumberofn-permutationswithkdescents[43]Arecordorleft-to-rightmaximumofapermutationσisanelementisuchthatσ(j)<σ(i)forallj<iFoata'sfundamentalbijectiontransformsapermutationσ{\displaystyle\sigma}withagivencanonicalcycleformintothepermutationf(σ)=σ^{\displaystylef(\sigma)={\hat{\sigma}}}whoseone-linenotationhasthesamesequenceofelementswithparenthesesremoved[24][44]Forexample:σ=(513)(6)(827)(94)=(123456789375916824),{\displaystyle\sigma=(513)(6)(827)(94)={\begin{pmatrix}1&2&3&4&5&6&7&8&9\\3&7&5&9&1&6&8&2&4\end{pmatrix}},}σ^=513682794=(123456789513682794){\displaystyle{\hat{\sigma}}=513682794={\begin{pmatrix}1&2&3&4&5&6&7&8&9\\5&1&3&6&8&2&7&9&4\end{pmatrix}}}Herethefirstelementineachcanonicalcycleofσ{\displaystyle\sigma}becomesarecord(left-to-rightmaximum)ofσ^{\displaystyle{\hat{\sigma}}}Givenσ^{\displaystyle{\hat{\sigma}}},onemayfinditsrecordsandinsertparenthesestoconstructtheinversetransformationσ=f−1(σ^){\displaystyle\sigma=f^{-1}({\hat{\sigma}})}Underliningtherecordsintheaboveexample:σ^=5_136_8_279_4{\displaystyle{\hat{\sigma}}={\underline{5}}\,1\,3\,{\underline{6}}\,{\underline{8}}\,2\,7\,{\underline{9}}\,4},whichallowsthereconstructionofthecyclesofσ{\displaystyle\sigma}Thefollowingtableshowsσ^{\displaystyle{\hat{\sigma}}}andσ{\displaystyle\sigma}forthesixpermutationsofS={1,2,3},withtheboldtextoneachsideshowingthenotationusedinthebijection:one-linenotationforσ^{\displaystyle{\hat{\sigma}}}andcanonicalcyclenotationforσ{\displaystyle\sigma}Notethatthefirst3permutationsaremappedtothemselvesunderthebijectionAsafirstcorollary,thenumberofn-permutationswithexactlykrecordsisequaltothenumberofn-permutationswithexactlykcycles:thislastnumberisthesignlessStirlingnumberofthefirstkind,c(n,k){\displaystylec(n,k)}Furthermore,Foata'smappingtakesann-permutationwithkweakexceedancestoann-permutationwithk−1ascents[44]Forexample,(2)(31)=321hask=2weakexceedances(atindex1and2),whereasf(321)=231hask−1=1ascent(atindex1;thatis,from2to3)Aninversionofapermutationσisapair(i,j)ofpositionswheretheentriesofapermutationareintheoppositeorder:i<j{\displaystylei<j}andσ(i)>σ(j){\displaystyle\sigma(i)>\sigma(j)}[46]ThusadescentisaninversionattwoadjacentpositionsForexample,σ=23154has(i,j)=(1,3),(2,3),and(4,5),where(σ(i),σ(j))=(2,1),(3,1),and(5,4)Sometimesaninversionisdefinedasthepairofvalues(σ(i),σ(j));thismakesnodifferenceforthenumberofinversions,andthereversepair(σ(j),σ(i))isaninversionintheabovesensefortheinversepermutationσ−1Thenumberofinversionsisanimportantmeasureforthedegreetowhichtheentriesofapermutationareoutoforder;itisthesameforσandforσ−1Tobringapermutationwithkinversionsintoorder(thatis,transformitintotheidentitypermutation),bysuccessivelyapplying(right-multiplicationby)adjacenttranspositions,isalwayspossibleandrequiresasequenceofksuchoperationsMoreover,anyreasonablechoicefortheadjacenttranspositionswillwork:itsufficestochooseateachstepatranspositionofiandi+1whereiisadescentofthepermutationasmodifiedsofar(sothatthetranspositionwillremovethisparticulardescent,althoughitmightcreateotherdescents)Thisissobecauseapplyingsuchatranspositionreducesthenumberofinversionsby1;aslongasthisnumberisnotzero,thepermutationisnottheidentity,soithasatleastonedescentBubblesortandinsertionsortcanbeinterpretedasparticularinstancesofthisproceduretoputasequenceintoorderIncidentallythisprocedureprovesthatanypermutationσcanbewrittenasaproductofadjacenttranspositions;forthisonemaysimplyreverseanysequenceofsuchtranspositionsthattransformsσintotheidentityInfact,byenumeratingallsequencesofadjacenttranspositionsthatwouldtransformσintotheidentity,oneobtains(afterreversal)acompletelistofallexpressionsofminimallengthwritingσasaproductofadjacenttranspositionsThenumberofpermutationsofnwithkinversionsisexpressedbyaMahoniannumber[47]Thisisthecoefficientofqk{\displaystyleq^{k}}intheexpansionoftheproduct[n]q!=∏m=1n∑i=0m−1qi=1(1+q)(1+q+q2)⋯(1+q+q2+⋯+qn−1),{\displaystyle[n]_{q}!=\prod_{m=1}^{n}\sum_{i=0}^{m-1}q^{i}=1\left(1+q\right)\left(1+q+q^{2}\right)\cdots\left(1+q+q^{2}+\cdots+q^{n-1}\right),}Thenotation[n]q!{\displaystyle[n]_{q}!}denotestheq-factorialThisexpansioncommonlyappearsinthestudyofnecklacesLetσ∈Sn,i,j∈{1,2,…,n}{\displaystyle\sigma\inS_{n},i,j\in\{1,2,\dots,n\}}suchthati<j{\displaystylei<j}andσ(i)>σ(j){\displaystyle\sigma(i)>\sigma(j)}Inthiscase,saytheweightoftheinversion(i,j){\displaystyle(i,j)}isσ(i)−σ(j){\displaystyle\sigma(i)-\sigma(j)}Kobayashi(2011)provedtheenumerationformula∑i<j,σ(i)>σ(j)(σ(i)−σ(j))=|{τ∈Sn∣τ≤σ,τisbigrassmannian}{\displaystyle\sum_{i<j,\sigma(i)>\sigma(j)}(\sigma(i)-\sigma(j))=|\{\tau\inS_{n}\mid\tau\leq\sigma,\tau{\text{isbigrassmannian}}\}}where≤{\displaystyle\leq}denotesBruhatorderinthesymmetricgroupsThisgradedpartialorderoftenappearsinthecontextofCoxetergroupsOnewaytorepresentpermutationsofnthingsisbyanintegerNwith0≤N<n!,providedconvenientmethodsaregiventoconvertbetweenthenumberandtherepresentationofapermutationasanorderedarrangement(sequence)Thisgivesthemostcompactrepresentationofarbitrarypermutations,andincomputingisparticularlyattractivewhennissmallenoughthatNcanbeheldinamachineword;for32-bitwordsthismeansn≤12,andfor64-bitwordsthismeansn≤20Theconversioncanbedoneviatheintermediateformofasequenceofnumbersdn,dn−1,,d2,d1,wherediisanon-negativeintegerlessthani(onemayomitd1,asitisalways0,butitspresencemakesthesubsequentconversiontoapermutationeasiertodescribe)ThefirststepthenistosimplyexpressNinthefactorialnumbersystem,whichisjustaparticularmixedradixrepresentation,where,fornumberslessthann!,thebases(placevaluesormultiplicationfactors)forsuccessivedigitsare(n−1)!,(n−2)!,,2!,1!ThesecondstepinterpretsthissequenceasaLehmercodeor(almostequivalently)asaninversiontableIntheLehmercodeforapermutationσ,thenumberdnrepresentsthechoicemadeforthefirsttermσ1,thenumberdn−1representsthechoicemadeforthesecondtermσ2amongtheremainingn−1elementsoftheset,andsoforthMoreprecisely,eachdn+1−igivesthenumberofremainingelementsstrictlylessthanthetermσiSincethoseremainingelementsareboundtoturnupassomelatertermσj,thedigitdn+1−icountstheinversions(i,j)involvingiassmallerindex(thenumberofvaluesjforwhichi<jandσi>σj)Theinversiontableforσisquitesimilar,butheredn+1−kcountsthenumberofinversions(i,j)wherek=σjoccursasthesmallerofthetwovaluesappearingininvertedorder[48]BothencodingscanbevisualizedbyannbynRothediagram[49](namedafterHeinrichAugustRothe)inwhichdotsat(i,σi)marktheentriesofthepermutation,andacrossat(i,σj)markstheinversion(i,j);bythedefinitionofinversionsacrossappearsinanysquarethatcomesbothbeforethedot(j,σj)initscolumn,andbeforethedot(i,σi)initsrowTheLehmercodeliststhenumbersofcrossesinsuccessiverows,whiletheinversiontableliststhenumbersofcrossesinsuccessivecolumns;itisjusttheLehmercodefortheinversepermutation,andviceversaToeffectivelyconvertaLehmercodedn,dn−1,,d2,d1intoapermutationofanorderedsetS,onecanstartwithalistoftheelementsofSinincreasingorder,andforiincreasingfrom1tonsetσitotheelementinthelistthatisprecededbydn+1−iotherones,andremovethatelementfromthelistToconvertaninversiontabledn,dn−1,,d2,d1intothecorrespondingpermutation,onecantraversethenumbersfromd1todnwhileinsertingtheelementsofSfromlargesttosmallestintoaninitiallyemptysequence;atthestepusingthenumberdfromtheinversiontable,theelementfromSinsertedintothesequenceatthepointwhereitisprecededbydelementsalreadypresentAlternativelyonecouldprocessthenumbersfromtheinversiontableandtheelementsofSbothintheoppositeorder,startingwitharowofnemptyslots,andateachstepplacetheelementfromSintotheemptyslotthatisprecededbydotheremptyslotsConvertingsuccessivenaturalnumberstothefactorialnumbersystemproducesthosesequencesinlexicographicorder(asisthecasewithanymixedradixnumbersystem),andfurtherconvertingthemtopermutationspreservesthelexicographicordering,providedtheLehmercodeinterpretationisused(usinginversiontables,onegetsadifferentordering,whereonestartsbycomparingpermutationsbytheplaceoftheirentries1ratherthanbythevalueoftheirfirstentries)Thesumofthenumbersinthefactorialnumbersystemrepresentationgivesthenumberofinversionsofthepermutation,andtheparityofthatsumgivesthesignatureofthepermutationMoreover,thepositionsofthezeroesintheinversiontablegivethevaluesofleft-to-rightmaximaofthepermutation(intheexample6,8,9)whilethepositionsofthezeroesintheLehmercodearethepositionsoftheright-to-leftminima(intheexamplepositionsthe4,8,9ofthevalues1,2,5);thisallowscomputingthedistributionofsuchextremaamongallpermutationsApermutationwithLehmercodedn,dn−1,,d2,d1hasanascentn−iifandonlyifdi≥di+1IncomputingitmayberequiredtogeneratepermutationsofagivensequenceofvaluesThemethodsbestadaptedtodothisdependonwhetheronewantssomerandomlychosenpermutations,orallpermutations,andinthelattercaseifaspecificorderingisrequiredAnotherquestioniswhetherpossibleequalityamongentriesinthegivensequenceistobetakenintoaccount;ifso,oneshouldonlygeneratedistinctmultisetpermutationsofthesequenceAnobviouswaytogeneratepermutationsofnistogeneratevaluesfortheLehmercode(possiblyusingthefactorialnumbersystemrepresentationofintegersupton!),andconvertthoseintothecorrespondingpermutationsHowever,thelatterstep,whilestraightforward,ishardtoimplementefficiently,becauseitrequiresnoperationseachofselectionfromasequenceanddeletionfromit,atanarbitraryposition;oftheobviousrepresentationsofthesequenceasanarrayoralinkedlist,bothrequire(fordifferentreasons)aboutn2/4operationstoperformtheconversionWithnlikelytoberathersmall(especiallyifgenerationofallpermutationsisneeded)thatisnottoomuchofaproblem,butitturnsoutthatbothforrandomandforsystematicgenerationtherearesimplealternativesthatdoconsiderablybetterForthisreasonitdoesnotseemuseful,althoughcertainlypossible,toemployaspecialdatastructurethatwouldallowperformingtheconversionfromLehmercodetopermutationinO(nlogn)timeForgeneratingrandompermutationsofagivensequenceofnvalues,itmakesnodifferencewhetheroneappliesarandomlyselectedpermutationofntothesequence,orchoosesarandomelementfromthesetofdistinct(multiset)permutationsofthesequenceThisisbecause,eventhoughincaseofrepeatedvaluestherecanbemanydistinctpermutationsofnthatresultinthesamepermutedsequence,thenumberofsuchpermutationsisthesameforeachpossibleresultUnlikeforsystematicgeneration,whichbecomesunfeasibleforlargenduetothegrowthofthenumbern!,thereisnoreasontoassumethatnwillbesmallforrandomgenerationThebasicideatogeneratearandompermutationistogenerateatrandomoneofthen!sequencesofintegersd1,d2,,dnsatisfying0≤di<i(sinced1isalwayszeroitmaybeomitted)andtoconvertittoapermutationthroughabijectivecorrespondenceForthelattercorrespondenceonecouldinterpretthe(reverse)sequenceasaLehmercode,andthisgivesagenerationmethodfirstpublishedin1938byRonaldFisherandFrankYates[50]Whileatthetimecomputerimplementationwasnotanissue,thismethodsuffersfromthedifficultysketchedabovetoconvertfromLehmercodetopermutationefficientlyThiscanberemediedbyusingadifferentbijectivecorrespondence:afterusingditoselectanelementamongiremainingelementsofthesequence(fordecreasingvaluesofi),ratherthanremovingtheelementandcompactingthesequencebyshiftingdownfurtherelementsoneplace,oneswapstheelementwiththefinalremainingelementThustheelementsremainingforselectionformaconsecutiverangeateachpointintime,eventhoughtheymaynotoccurinthesameorderastheydidintheoriginalsequenceThemappingfromsequenceofintegerstopermutationsissomewhatcomplicated,butitcanbeseentoproduceeachpermutationinexactlyoneway,byanimmediateinductionWhentheselectedelementhappenstobethefinalremainingelement,theswapoperationcanbeomittedThisdoesnotoccursufficientlyoftentowarranttestingforthecondition,butthefinalelementmustbeincludedamongthecandidatesoftheselection,toguaranteethatallpermutationscanbegeneratedTheresultingalgorithmforgeneratingarandompermutationofa[0],a[1],,a[n−1]canbedescribedasfollowsinpseudocode:Thiscanbecombinedwiththeinitializationofthearraya[i]=iasfollowsIfdi+1=i,thefirstassignmentwillcopyanuninitializedvalue,butthesecondwilloverwriteitwiththecorrectvalueiHowever,Fisher-Yatesisnotthefastestalgorithmforgeneratingapermutation,becauseFisher-Yatesisessentiallyasequentialalgorithmand``divideandconquer''procedurescanachievethesameresultinparallel[51]Therearemanywaystosystematicallygenerateallpermutationsofagivensequence[52]Oneclassic,simple,andflexiblealgorithmisbaseduponfindingthenextpermutationinlexicographicordering,ifitexistsItcanhandlerepeatedvalues,forwhichcaseitgenerateseachdistinctmultisetpermutationonceEvenforordinarypermutationsitissignificantlymoreefficientthangeneratingvaluesfortheLehmercodeinlexicographicorder(possiblyusingthefactorialnumbersystem)andconvertingthosetopermutationsItbeginsbysortingthesequencein(weakly)increasingorder(whichgivesitslexicographicallyminimalpermutation),andthenrepeatsadvancingtothenextpermutationaslongasoneisfoundThemethodgoesbacktoNarayanaPanditain14thcenturyIndia,andhasbeenrediscoveredfrequently[53]ThefollowingalgorithmgeneratesthenextpermutationlexicographicallyafteragivenpermutationItchangesthegivenpermutationin-placeForexample,giventhesequence[1,2,3,4](whichisinincreasingorder),andgiventhattheindexiszero-based,thestepsareasfollows:Followingthisalgorithm,thenextlexicographicpermutationwillbe[1,3,2,4],andthe24thpermutationwillbe[4,3,2,1]atwhichpointa[k]<a[k+1]doesnotexist,indicatingthatthisisthelastpermutationThismethodusesabout3comparisonsand15swapsperpermutation,amortizedoverthewholesequence,notcountingtheinitialsort[54]Analternativetotheabovealgorithm,theSteinhaus–Johnson–Trotteralgorithm,generatesanorderingonallthepermutationsofagivensequencewiththepropertythatanytwoconsecutivepermutationsinitsoutputdifferbyswappingtwoadjacentvaluesThisorderingonthepermutationswasknownto17th-centuryEnglishbellringers,amongwhomitwasknownas``plainchanges''OneadvantageofthismethodisthatthesmallamountofchangefromonepermutationtothenextallowsthemethodtobeimplementedinconstanttimeperpermutationThesamecanalsoeasilygeneratethesubsetofevenpermutations,againinconstanttimeperpermutation,byskippingeveryotheroutputpermutation[53]AnalternativetoSteinhaus–Johnson–TrotterisHeap'salgorithm,[55]saidbyRobertSedgewickin1977tobethefastestalgorithmofgeneratingpermutationsinapplications[52]Thefollowingfigureshowstheoutputofallthreeaforementionedalgorithmsforgeneratingallpermutationsoflengthn=4{\displaystylen=4},andofsixadditionalalgorithmsdescribedintheliteratureMeandricsystemsgiverisetomeandricpermutations,aspecialsubsetofalternatepermutationsAnalternatepermutationoftheset{1,2,,2n}isacyclicpermutation(withnofixedpoints)suchthatthedigitsinthecyclicnotationformalternatebetweenoddandevenintegersMeandricpermutationsareusefulintheanalysisofRNAsecondarystructureNotallalternatepermutationsaremeandricAmodificationofHeap'salgorithmhasbeenusedtogenerateallalternatepermutationsofordern(thatis,oflength2n)withoutgeneratingall(2n)!permutations[61][unreliablesource?]GenerationofthesealternatepermutationsisneededbeforetheyareanalyzedtodetermineiftheyaremeandricornotThealgorithmisrecursiveThefollowingtableexhibitsastepintheprocedureInthepreviousstep,allalternatepermutationsoflength5havebeengeneratedThreecopiesofeachofthesehavea``6''addedtotherightend,andthenadifferenttranspositioninvolvingthislastentryandapreviousentryinanevenpositionisapplied(includingtheidentity;thatis,notransposition)Permutationsareusedintheinterleavercomponentoftheerrordetectionandcorrectionalgorithms,suchasturbocodes,forexample3GPPLongTermEvolutionmobiletelecommunicationstandardusestheseideas(see3GPPtechnicalspecification36212[62])SuchapplicationsraisethequestionoffastgenerationofpermutationssatisfyingcertaindesirablepropertiesOneofthemethodsisbasedonthepermutationpolynomialsAlsoasabaseforoptimalhashinginUniquePermutationHashing[63]